<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Game Data Viewer</title>

    <link rel="icon" type="image/png" href="assets/images/favicon.png">
    <link rel="apple-touch-icon" href="assets/images/favicon.png">
    <meta name="msapplication-TileImage" content="assets/images/favicon.png">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VBDXSGTNQZ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-VBDXSGTNQZ');
    </script>

    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/colreorder/1.6.2/css/colReorder.dataTables.min.css">
    <link rel="stylesheet" href="css/styles.css">

</head>


<body>

    <script>

        window.GDV = {
            utils: {},
            controller: {},
            state: {},
            helpNotice: {},
            loading: {},
            csvHandler: {},
            datatable: {},
            prefilter: {},
            localImageViewer: {},
            dom: {},
        };

    </script>

    <script src="js/utils.js"></script>
    <script src="js/helpNotice.js"></script>


    <div class="controls">
        <div class="controls-header">
            <h2 class="controls-title">
                <img src="assets/images/favicon.png" alt="Game Data Viewer Icon" class="controls-title-icon">
                Game Data Viewer
            </h2>
            <div class="btn-group" id="controlsButtonGroup">
                <button id="themeToggleButton" class="btn btn-secondary" title="Toggle between light and dark theme">ğŸŒ™
                    Dark</button>
                <button id="discussionButton" class="btn btn-secondary" title="Join the discussion about the tool">ğŸ‘¥
                    Discussion</button>
                <button id="feedbackButton" class="btn btn-secondary"
                    title="Provide feedback or suggestions about the tool">ğŸ’¬ Feedback</button>
                <button id="tagPatternsButton" class="btn btn-secondary" title="View the full tag regex patterns">ğŸ“„ Tag
                    Patterns</button>
                <button id="resetFiltersButton" class="btn btn-secondary"
                    title="Reset all filters and sorting to their default state">ğŸ”„ Reset Column Filters</button>
                <button id="searchButton" class="btn" title="Search the game data">ğŸ” Search</button>
            </div>
            <script>
                const btnGroup = document.getElementById('controlsButtonGroup');
                btnGroup.insertAdjacentElement('afterend', GDV.helpNotice.createHelpNotice());
            </script>
        </div>

        <div class="controls-main-grid">
            <div class="status-card">
                <div class="btn-group">
                    <input type="file" id="csvFile" accept=".csv">
                    <input type="file" id="columnDetailsFileInput" accept=".json" style="display:none">
                    <button id="fileButton" class="btn" style="flex:1"
                        title="Select a CSV file to load into the table">ğŸ“‚ Select CSV</button>
                    <button id="columnDetailsFileButton" class="btn btn-secondary" style="flex:1"
                        title="Select a JSON file containing column details">ğŸ“‘ Load Column Details</button>
                    <button id="selectGamesFolderButton" class="btn btn-secondary" style="flex:1"
                        title="Select the games folder containing your data files">ğŸ“ Set Games Folder</button>
                    <button id="controlsPinButton" class="btn btn-secondary"
                        title="Pin the controls panel to stay open">ğŸ“Œ</button>
                </div>
                <div class="controls-status-item">
                    <span class="controls-label">Loaded CSV:</span>
                    <span id="csvFileDisplay" class="controls-value">(None)</span>
                </div>
                <div class="controls-status-item">
                    <span class="controls-label">Loaded Column Details:</span>
                    <span id="columnDetailsDisplay" class="controls-value">(None)</span>
                </div>
                <div class="controls-status-item">
                    <span class="controls-label">Loaded tag patterns:</span>
                    <span id="tagPatternsDisplay" class="controls-value">(None)</span>
                </div>
                <div class="controls-status-item">
                    <span class="controls-label">Loaded thumbnails:</span>
                    <span id="thumbnailsDisplay" class="controls-value">(None)</span>
                </div>
                <div class="controls-status-item">
                    <span class="controls-label">Games Folder Path:</span>
                    <span id="gamesFolderDisplay" class="controls-value">(Not Set)</span>
                </div>
            </div>

            <div id="csvDropZone">
                <span>Drop <strong>Analysis CSV</strong> here</span>
            </div>
        </div>

    </div>

    <div id="mainPrefiltersPanelSection"></div>

    <table id="csvTable" class="display"></table>

    <div id="loadingOverlayElement">
        <div id="loadingOverlayLabel">Loading Data...</div>
        <div class="spinner"></div>
        <div id="loadingOverlayProgressContainer">
            <div id="loadingOverlayProgressBar"></div>
            <span id="loadingOverlayProgressText">0%</span>
        </div>
        <button id="loadingOverlayStopButton">â¹ Stop</button>
    </div>


    <div id="previewOverlay">
        <img id="previewImage" alt="preview">
    </div>

    <div id="localImagesModal">
        <div id="localImagesModalHeader">
            <span id="localImagesModalTitle">Images</span>
            <button class="btn" id="closeImageModal">âœ•</button>
        </div>
        <div id="localImagesModalGrid"></div>
    </div>

    <div id="localImagesOverlay">
        <img id="localImagesOverlayImg">
    </div>


    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/colreorder/1.6.2/js/dataTables.colReorder.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>


    <script src="js/controller.js"></script>
    <script src="js/state.js"></script>
    <script src="js/dom.js"></script>
    <script src="js/loading.js"></script>
    <script src="js/csv-handler.js"></script>
    <script src="js/datatable.js"></script>
    <script src="js/prefilter.js"></script>
    <script src="js/local-image-viewer.js"></script>



    <script>
        GDV.controller.initialize()
    </script>


</body>

</html>